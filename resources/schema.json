{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "player-analytics-specification",
  "patternProperties": {
    "^.*$": {
      "anyOf": [
        { "$ref": "#/$defs/init", "type": "object" },
        { "$ref": "#/$defs/bitrate_changed", "type": "object" },
        { "$ref": "#/$defs/buffered", "type": "object" },
        { "$ref": "#/$defs/buffering", "type": "object" },
        { "$ref": "#/$defs/error", "type": "object" },
        { "$ref": "#/$defs/heartbeat", "type": "object" },
        { "$ref": "#/$defs/loaded", "type": "object" },
        { "$ref": "#/$defs/loading", "type": "object" },
        { "$ref": "#/$defs/pause", "type": "object" },
        { "$ref": "#/$defs/play", "type": "object" },
        { "$ref": "#/$defs/playing", "type": "object" },
        { "$ref": "#/$defs/resume", "type": "object" },
        { "$ref": "#/$defs/seeked", "type": "object" },
        { "$ref": "#/$defs/seeking", "type": "object" },
        { "$ref": "#/$defs/stopped", "type": "object" },
        { "$ref": "#/$defs/warning", "type": "object" }
      ]
    }
  },
  "additionalProperties": false,
  "$defs": {
    "Record": {
      "$id": "Record",
      "type": "object"
    },
    "bitrate_changed": {
      "allOf": [
        {
          "properties": {
            "duration": {
              "type": "number"
            },
            "playhead": {
              "type": "number"
            },
            "timestamp": {
              "type": "number"
            }
          },
          "type": "object"
        },
        {
          "properties": {
            "event": {
              "enum": ["bitrate_changed"],
              "type": "string"
            },
            "payload": {
              "properties": {
                "audioBitrate": {
                  "type": "number"
                },
                "bitrate": {
                  "type": "number"
                },
                "height": {
                  "type": "number"
                },
                "videoBitrate": {
                  "type": "number"
                },
                "width": {
                  "type": "number"
                }
              },
              "type": "object"
            }
          },
          "type": "object"
        }
      ]
    },
    "buffered": {
      "allOf": [
        {
          "properties": {
            "duration": {
              "type": "number"
            },
            "playhead": {
              "type": "number"
            },
            "timestamp": {
              "type": "number"
            }
          },
          "type": "object"
        },
        {
          "properties": {
            "event": {
              "enum": ["buffered"],
              "type": "string"
            }
          },
          "type": "object"
        }
      ]
    },
    "buffering": {
      "allOf": [
        {
          "properties": {
            "duration": {
              "type": "number"
            },
            "playhead": {
              "type": "number"
            },
            "timestamp": {
              "type": "number"
            }
          },
          "type": "object"
        },
        {
          "properties": {
            "event": {
              "enum": ["buffering"],
              "type": "string"
            }
          },
          "type": "object"
        }
      ]
    },
    "error": {
      "allOf": [
        {
          "properties": {
            "duration": {
              "type": "number"
            },
            "playhead": {
              "type": "number"
            },
            "timestamp": {
              "type": "number"
            }
          },
          "type": "object"
        },
        {
          "properties": {
            "event": {
              "enum": ["error"],
              "type": "string"
            },
            "payload": {
              "properties": {
                "category": {
                  "type": "string"
                },
                "code": {
                  "type": "string"
                },
                "data": {
                  "$ref": "#/$defs/Record"
                },
                "message": {
                  "type": "string"
                }
              },
              "type": "object"
            }
          },
          "type": "object"
        }
      ]
    },
    "init": {
      "allOf": [
        {
          "properties": {
            "additionalProperties": false,
            "duration": {
              "type": "number"
            },
            "playhead": {
              "type": "number"
            },
            "timestamp": {
              "type": "number"
            }
          },
          "type": "object",
          "required": ["duration", "playhead", "timestamp"]
        },
        {
          "properties": {
            "additionalProperties": false,
            "event": {
              "enum": ["init"],
              "type": "string"
            },
            "heartbeatInterval": {
              "type": "number"
            },
            "payload": {
              "allOf": [
                {
                  "$ref": "#/$defs/Record"
                },
                {
                  "properties": {
                    "additionalProperties": false,
                    "contentId": {
                      "type": "string"
                    },
                    "contentUrl": {
                      "type": "string"
                    },
                    "deviceId": {
                      "type": "string"
                    },
                    "deviceModel": {
                      "type": "string"
                    },
                    "deviceType": {
                      "type": "string"
                    },
                    "drmType": {
                      "type": "string"
                    },
                    "live": {
                      "type": "boolean"
                    },
                    "userId": {
                      "type": "string"
                    }
                  },
                  "type": "object",
                  "required": [
                    "contentId",
                    "contentUrl",
                    "deviceId",
                    "deviceModel",
                    "deviceType",
                    "drmType",
                    "live",
                    "userId"
                  ]
                }
              ]
            },
            "sessionId": {
              "type": "string"
            }
          },
          "type": "object"
        }
      ]
    },
    "loading": {
      "allOf": [
        {
          "properties": {
            "duration": {
              "type": "number"
            },
            "playhead": {
              "type": "number"
            },
            "timestamp": {
              "type": "number"
            }
          },
          "type": "object",
          "required": ["duration", "playhead", "timestamp"]
        },
        {
          "properties": {
            "event": {
              "enum": ["loading"],
              "type": "string"
            }
          },
          "type": "object",
          "required": ["event"]
        }
      ]
    },
    "loaded": {
      "allOf": [
        {
          "properties": {
            "duration": {
              "type": "number"
            },
            "playhead": {
              "type": "number"
            },
            "timestamp": {
              "type": "number"
            }
          },
          "type": "object",
          "required": ["duration", "playhead", "timestamp"]
        },
        {
          "properties": {
            "event": {
              "enum": ["loaded"],
              "type": "string"
            }
          },
          "type": "object",
          "required": ["event"]
        }
      ]
    },
    "play": {
      "allOf": [
        {
          "properties": {
            "duration": {
              "type": "number"
            },
            "playhead": {
              "type": "number"
            },
            "timestamp": {
              "type": "number"
            }
          },
          "type": "object",
          "required": ["duration", "playhead", "timestamp"]
        },
        {
          "properties": {
            "event": {
              "enum": ["play"],
              "type": "string"
            }
          },
          "type": "object",
          "required": ["event"]
        }
      ]
    },
    "playing": {
      "allOf": [
        {
          "properties": {
            "duration": {
              "type": "number"
            },
            "playhead": {
              "type": "number"
            },
            "timestamp": {
              "type": "number"
            }
          },
          "type": "object",
          "required": ["duration", "playhead", "timestamp"]
        },
        {
          "properties": {
            "event": {
              "enum": ["playing"],
              "type": "string"
            }
          },
          "type": "object",
          "required": ["event"]
        }
      ]
    },
    "pause": {
      "allOf": [
        {
          "properties": {
            "duration": {
              "type": "number"
            },
            "playhead": {
              "type": "number"
            },
            "timestamp": {
              "type": "number"
            }
          },
          "type": "object",
          "required": ["duration", "playhead", "timestamp"]
        },
        {
          "properties": {
            "event": {
              "enum": ["pause"],
              "type": "string"
            }
          },
          "type": "object",
          "required": ["event"]
        }
      ]
    },
    "resume": {
      "allOf": [
        {
          "properties": {
            "duration": {
              "type": "number"
            },
            "playhead": {
              "type": "number"
            },
            "timestamp": {
              "type": "number"
            }
          },
          "type": "object",
          "required": ["duration", "playhead", "timestamp"]
        },
        {
          "properties": {
            "event": {
              "enum": ["resume"],
              "type": "string"
            }
          },
          "type": "object",
          "required": ["event"]
        }
      ]
    },
    "seeking": {
      "allOf": [
        {
          "properties": {
            "duration": {
              "type": "number"
            },
            "playhead": {
              "type": "number"
            },
            "timestamp": {
              "type": "number"
            }
          },
          "type": "object",
          "required": ["duration", "playhead", "timestamp"]
        },
        {
          "properties": {
            "event": {
              "enum": ["seeking"],
              "type": "string"
            }
          },
          "type": "object",
          "required": ["event"]
        }
      ]
    },
    "seeked": {
      "allOf": [
        {
          "properties": {
            "duration": {
              "type": "number"
            },
            "playhead": {
              "type": "number"
            },
            "timestamp": {
              "type": "number"
            }
          },
          "type": "object",
          "required": ["duration", "playhead", "timestamp"]
        },
        {
          "properties": {
            "event": {
              "enum": ["seeked"],
              "type": "string"
            }
          },
          "type": "object",
          "required": ["event"]
        }
      ]
    },
    "warning": {
      "allOf": [
        {
          "properties": {
            "duration": {
              "type": "number"
            },
            "playhead": {
              "type": "number"
            },
            "timestamp": {
              "type": "number"
            }
          },
          "type": "object",
          "required": ["duration", "playhead", "timestamp"]
        },
        {
          "properties": {
            "event": {
              "enum": ["warning"],
              "type": "string"
            },
            "payload": {
              "properties": {
                "category": {
                  "type": "string"
                },
                "code": {
                  "type": "string"
                },
                "data": {
                  "$ref": "#/$defs/Record"
                },
                "message": {
                  "type": "string"
                }
              },
              "type": "object",
              "required": ["category", "code", "message"]
            }
          },
          "type": "object",
          "required": ["event", "payload"]
        }
      ]
    },
    "stopped": {
      "allOf": [
        {
          "properties": {
            "duration": {
              "type": "number"
            },
            "playhead": {
              "type": "number"
            },
            "timestamp": {
              "type": "number"
            }
          },
          "type": "object",
          "required": ["duration", "playhead", "timestamp"]
        },
        {
          "properties": {
            "event": {
              "enum": ["stopped"],
              "type": "string"
            },
            "sessionId": {
              "type": "string"
            }
          },
          "type": "object",
          "required": ["event", "sessionId"]
        }
      ]
    },
    "heartbeat": {
      "allOf": [
        {
          "properties": {
            "duration": {
              "type": "number"
            },
            "playhead": {
              "type": "number"
            },
            "timestamp": {
              "type": "number"
            }
          },
          "type": "object",
          "required": ["duration", "playhead", "timestamp"]
        },
        {
          "properties": {
            "event": {
              "enum": ["heartbeat"],
              "type": "string"
            },
            "sessionId": {
              "type": "string"
            }
          },
          "type": "object",
          "required": ["event", "sessionId"]
        }
      ]
    }
  }
}
